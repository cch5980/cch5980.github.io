# ReactJS-18 ë¦¬ë•ìŠ¤ ë¯¸ë“¤ì›¨ì–´ë¥¼ í†µí•œ ë¹„ë™ê¸° ì‘ì—…ê´€ë¦¬

- ë¦¬ì•¡íŠ¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ API ì„œë²„ë¥¼ ì—°ë™í•  ë•ŒëŠ” API ìš”ì²­ì— ëŒ€í•œ ìƒíƒœë„ ì˜ ê´€ë¦¬í•´ì•¼ í•œë‹¤.
- ìš”ì²­ì´ ì‹œì‘ë˜ì—ˆì„ ë•ŒëŠ” ë¡œë”© ì¤‘ì„ì„, ìš”ì²­ì´ ì„±ê³µí•˜ê±°ë‚˜ ì‹¤íŒ¨í–ˆì„ ë•ŒëŠ” ë¡œë”©ì´ ëë‚¬ìŒì„ ëª…ì‹œí•´ì•¼ í•œë‹¤.
- ìš”ì²­ì´ ì„±ê³µí•˜ë©´ ì„œë²„ì—ì„œ ë°›ì•„ ì˜¨ ì‘ë‹µì— ëŒ€í•œ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ê³ , ìš”ì²­ì´ ì‹¤íŒ¨í•˜ë©´ ì„œë²„ì—ì„œ ë°˜í™˜í•œ ì—ëŸ¬ì— ëŒ€í•œ ìƒíƒœë¥¼ ê´€ë¦¬í•´ì•¼ í•œë‹¤.



## ğŸ”¥1. ì‘ì—… í™˜ê²½ ì¤€ë¹„

```bash
$ yarn create react-app learn-redux-middleware
$ yarn add redux react-redux redux-actions
```

### 1-1) ë¦¬ë•ìŠ¤ë¥¼ ìœ„í•œ ì½”ë“œ

```react
// src/modules/counter.js
import { createAction, handleActions } from 'redux-actions';

const INCREASE = 'counter/INCREASE';
const DECREASE = 'counter/DECREASE';

export const increase = createAction(INCREASE);
export const decrease = createAction(DECREASE);

const initialState = 0; // ìƒíƒœëŠ” ê¼­ ê°ì²´ì¼ í•„ìš”ê°€ ì—†ë‹¤.

const counter = handleActions(
    {
        [INCREASE]: state => state + 1,
        [DECREASE]: state => state - 1,
    },
    initialState
);

export default counter;
```

```react
// src/modules/index.js
import { combineReducers } from 'redux';
import counter from './counter';

const rootReducer = combineReducers({
    counter
});

export default rootReducer;
```

```react
// src/index.js
import React from 'react';
import ReactDOM from 'react-dom';
import './index.css';
import App from './App';
import { createStore } from 'redux';
import { Provider } from 'react-redux';
import rootReducer from './modules';

const store = createStore(rootReducer);

ReactDOM.render(
  <Provider store={store}>
    <App />
  </Provider>,
  document.getElementById('root')
);
```



### 1-2) í”„ë ˆì  í…Œì´ì…”ë„ ì»´í¬ë„ŒíŠ¸ì™€ ì»¨í…Œì´ë„ˆ ì»´í¬ë„ŒíŠ¸ ì‘ì„±

```react
// src/components/Counter.js
import React from 'react';

const Counter = ({ onIncrease, onDecrease, number }) => {
    return (
        <div>
            <h1>{number}</h1>
            <button onClick={onIncrease}>+1</button>
            <button onClick={onDecrease}>-1</button>
        </div>
    );
};

export default Counter;
```

```react
// src/containers/CounterContainer.js
import React from 'react';
import { connect } from 'react-redux';
import { increase, decrease } from '../modules/counter';
import Counter from '../components/Counter';

const CounterContainer = ({ number, increase, decrease }) => {
    return (
        <Counter number={number} onIncrease={increase} onDecrease={decrease} />
    );
};

export default connect(
    state => ({
        number: state.counter
    }),
    {
        increase,
        decrease
    }
)(CounterContainer);
```

```react
// src/App.js
import React from 'react';
import CounterContainer from './containers/CounterContainer';

const App = () => {
  return (
    <div>
      <CounterContainer />
    </div>
  );
};

export default App;
```

![reactjs-18-01](md-images/reactjs-18-01.JPG)





## ğŸ”¥2. ë¯¸ë“¤ì›¨ì–´

- ë¦¬ë•ìŠ¤ ë¯¸ë“¤ì›¨ì–´ëŠ” ì•¡ì…˜ì„ ë””ìŠ¤íŒ¨ì¹˜í–ˆì„ ë•Œ ë¦¬ë“€ì„œì—ì„œ ì´ë¥¼ ì²˜ë¦¬í•˜ê¸°ì— ì•ì„œ **ì‚¬ì „ì— ì§€ì •ëœ ì‘ì—…ë“¤ì„ ì‹¤í–‰**í•œë‹¤.
- ë¯¸ë“¤ì›¨ì–´ëŠ” **ì•¡ì…˜ê³¼ ë¦¬ë“€ì„œ ì‚¬ì´ì˜ ì¤‘ê°„ì**ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.

![reactjs-18-02](md-images/reactjs-18-02.JPG)

- ë¦¬ë“€ì„œê°€ ì•¡ì…˜ì„ ì²˜ë¦¬í•˜ê¸° ì „ì— ë¯¸ë“¤ì›¨ì–´ê°€ í•  ìˆ˜ ìˆëŠ” ì‘ì—…
  - ì „ë‹¬ë°›ì€ ì•¡ì…˜ì„ ë‹¨ìˆœíˆ ì½˜ì†”ì— ê¸°ë¡
  - ì „ë‹¬ë°›ì€ ì•¡ì…˜ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì•¡ì…˜ì„ ì•„ì˜ˆ ì·¨ì†Œí•˜ê±°ë‚˜, ë‹¤ë¥¸ ì¢…ë¥˜ì˜ ì•¡ì…˜ì„ ì¶”ê°€ë¡œ ë””ìŠ¤íŒ¨ì¹˜í•  ìˆ˜ ìˆë‹¤.



### 2-1) ë¯¸ë“¤ì›¨ì–´ ë§Œë“¤ê¸°

- ì•¡ì…˜ì´ ë””ìŠ¤íŒ¨ì¹˜ë  ë•Œë§ˆë‹¤ **ì•¡ì…˜ì˜ ì •ë³´**ì™€ **ì•¡ì…˜ì´ ë””ìŠ¤íŒ¨ì¹˜ë˜ê¸° ì „í›„ì˜ ìƒíƒœ**ë¥¼ ì½˜ì†”ì— ë³´ì—¬ì£¼ëŠ” ë¡œê¹… ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‘ì„±í•´ë³¸ë‹¤.

```react
// src/lib/loggerMiddleware.js
const loggerMiddleware = store => next => action => {
    // ë¯¸ë“¤ì›¨ì–´ ê¸°ë³¸ êµ¬ì¡°
};

export default loggerMiddleware;
```

- í™”ì‚´í‘œ í•¨ìˆ˜ë¥¼ ì—°ë‹¬ì•„ì„œ ì‚¬ìš©í–ˆëŠ”ë°, ì¼ë°˜ function í‚¤ì›Œë“œë¡œ í’€ì–´ì„œ ì“´ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

```react
const loggerMiddleware = function loggerMiddleware(store) {
    return function(next) {
        return function(action) {
            // ë¯¸ë“¤ì›¨ì–´ ê¸°ë³¸ êµ¬ì¡°
        };
    };
};
```

- ë¯¸ë“¤ì›¨ì–´ëŠ” í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.
- í•¨ìˆ˜ì—ì„œ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ì˜¤ëŠ” ê°’
  - `store`ëŠ” ë¦¬ë•ìŠ¤ ìŠ¤í† ì–´ ì¸ìŠ¤í„´ìŠ¤
  - `action`ì€ ë””ìŠ¤íŒ¨ì¹˜ëœ ì•¡ì…˜ì„ ê°€ë¦¬í‚¨ë‹¤.
  - `next` íŒŒë¼ë¯¸í„°ëŠ” í•¨ìˆ˜ í˜•íƒœì´ë©°, `store.dispatch`ì™€ ë¹„ìŠ·í•œ ì—­í• ì„ í•œë‹¤. ì°¨ì´ì ì€ `next(action)` ì„ í˜¸ì¶œí•˜ë©´ **ê·¸ ë‹¤ìŒ ì²˜ë¦¬í•´ì•¼ í•  ë¯¸ë“¤ì›¨ì–´ì—ê²Œ ì•¡ì…˜ì„ ë„˜ê²¨ì£¼ê³ **, ë§Œì•½ ê·¸ë‹¤ìŒ ë¯¸ë“¤ì›¨ì–´ê°€ ì—†ë‹¤ë©´ **ë¦¬ë“€ì„œì—ê²Œ ì•¡ì…˜ì„ ë„˜ê²¨ì¤€ë‹¤.**
- ë¯¸ë“¤ì›¨ì–´ ë‚´ë¶€ì—ì„œ `store.dispatch`ë¥¼ ì‚¬ìš©í•˜ë©´ ì²« ë²ˆì§¸ ë¯¸ë“¤ì›¨ì–´ë¶€í„° ë‹¤ì‹œ ì²˜ë¦¬í•œë‹¤.
- ë§Œì•½ ë¯¸ë“¤ì›¨ì–´ì—ì„œ `next`ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ì•¡ì…˜ì´ ë¦¬ë“€ì„œì— ì „ë‹¬ë˜ì§€ ì•ŠëŠ”ë‹¤.

![reactjs-18-03](md-images/reactjs-18-03.JPG)

- ë¯¸ë“¤ì›¨ì–´ êµ¬í˜„
  - ì´ì „ ìƒíƒœ, ì•¡ì…˜ ì •ë³´, ìƒˆë¡œì›Œì§„ ìƒíƒœë¥¼ ì½˜ì†”ì— ë³´ì—¬ì¤€ë‹¤.

```react
// src/lib/loggerMiddleware.js
const loggerMiddleware = store => next => action => {
    console.group(action && action.type);   // ì•¡ì…˜ íƒ€ì…ìœ¼ë¡œ logë¥¼ ê·¸ë£¹í™”í•¨
    console.log('ì´ì „ ìƒíƒœ', store.getState());
    console.log('ì•¡ì…˜', action);
    next(action);   // ë‹¤ìŒ ë¯¸ë“¤ì›¨ì–´ í˜¹ì€ ë¦¬ë“€ì„œì—ê²Œ ì „ë‹¬
    console.log('ë‹¤ìŒ ìƒíƒœ', store.getState()); // ì—…ë°ì´íŠ¸ëœ ìƒíƒœ
    console.groupEnd(); // ê·¸ë£¹ ë
};

export default loggerMiddleware;
```

```react
// src/index.js
...
import { createStore, applyMiddleware } from 'redux';
...
import loggerMiddleware from './lib/loggerMiddleware';

const store = createStore(rootReducer, applyMiddleware(loggerMiddleware));

...
```

![reactjs-18-04](md-images/reactjs-18-04.JPG)



### 2-2) redux-logger ì‚¬ìš©í•˜ê¸°

```bash
$ yarn add redux-logger
```

```react
// src/index.js
...
// import loggerMiddleware from './lib/loggerMiddleware';
import { createLogger } from 'redux-logger';

const logger = createLogger();
const store = createStore(rootReducer, applyMiddleware(logger));
...
```

![reactjs-18-05](md-images/reactjs-18-05.JPG)



## ğŸ”¥3. ë¹„ë™ê¸° ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´ ì‚¬ìš©

